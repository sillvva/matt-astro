---
import theme from "$/theme.json";
import { cn } from "$/util";
import { Code } from "astro:components";
import { type BundledLanguage } from "shiki";
import CodeBlock from "./block/block.astro";
import CodeFrame from "./block/frame.astro";
import CodeLang from "./block/lang.astro";
import CodeNav from "./block/nav.astro";

interface Props {
	code: string;
	lang?: BundledLanguage;
	class?: string;
	wrap?: boolean;
}

const { code, lang, wrap, class: className } = Astro.props;
---

<CodeBlock class="shiki">
	<CodeNav />
	<CodeLang>
		{lang}
	</CodeLang>
	<CodeFrame>
		<Code
			{code}
			{lang}
			{wrap}
			theme={{
				name: theme.name,
				settings: theme.tokenColors
			}}
			class={cn(className, "group my-1")}
		/>
	</CodeFrame>
</CodeBlock>
