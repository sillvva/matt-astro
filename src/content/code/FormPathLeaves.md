---
name: FormPathLeaves
playground: https://www.typescriptlang.org/play?module=1#code/PTAEBUFEGV2goeAXAngBwKagDIHsDmAIgIZLGgC8oA3vKKAJYAmAXKAHYCuAtgEYYAnANx1Q3DAGcJxfBjYSkAhu3wj6TUnNAkkGNaE4TBAfja169Zmy59B++u2Lj5i5atEBffWXwSXSlQBtAF0RL0QAY1x2BVAAGwIdYjY8IlJyKnNGVlAARgAaUXEpGS0AIjLC9U1rDAB3bU0ACgBKKoMjATN4AEgrPMKex2dQMoAxAWJ2CIYJMs92nz9QEPgPRFRMHAJsDGIAN0lKUDHcAW4ABVIAC12DyQAeVKSAPhEQCwA9Y2R0LFToK4VHdDhJjqdzlckLc9qCnol0vlQAoAvg3vAPvRvr8tqkAHI8fgCEFHKgQy43EkSeFpMhImxE9GY0DYzb-BG6Kngs4U6FUmlJJE6DBMsBYn7wIxIABqxDinAwTQStOISLKGl0lQ49UauiaZQATAAGA0AZgAtCbLbkyi0WiIpbL5YrlYLRktAkbglqyroFLaRFEYrg4hgAHTKpUc4j2yUYGVyhVRlVqjUYH3Gg0AFmt1oDiA+AGEAPKESAFsDga5TADWYKQuFA1yQSDQfhACmIERruEOAgAZgk6mGotxgMRgAB2SdZgCsuVNADZJ1OjQAOACcWZxWAAkhIAILsFAPcAvY68XAhvbsUAYAAeunYTDBTXAd8fGGfYPYGD7oGMUBFAVUA2H7OUjBaACgIEECwIgvQNj+UAACFOAYOIkF3dhi14AArDAIiQMEqGFUAAB9QGgeMHk4dga3YXA6nYc9KLGDDEPgB80DOJAgOQg84jiABpDAUGpM9jnfB8nxfCBoJrMTcH7eTaj7EQuPvHiBD4tlQAuBhu3AP5TyRYSP1ksFBJEsSJJec8qGkz9vxoFYa0YW9hOCNgphQUAPGg8BAi80DtXUisIGrej60bZtW3bYAmD-MMG2AeUZimXgImAOiGGic02XNcQBHwNxzWUAq-gkCIlDQJBzQ3OVNO03TkIAWUEWQAFV2Dy9hTwcmhemCjzQGs0TxIG7z9MMmtjMwUzQGE9FwgxAAqNa6DWnBZmI0A5TiUA0BuMFlH229cHwwi+OIMEUTcfaIgiSQJDOCQwy24Bmt4-itnJKFrlPCyvzky6CKIpF5qwKhfMG+6VFAAAyXpAVRAHFuoUB+ww3QulAAByA78aEUAwYPNBMGfNS7COm42Hx4nfq0KH-PRdbNtAbbsF22noVO28plJq6iP2u6gXwR7nqkN6kV4Tg+OiOI-LqBhoQ4fKweusFbsll6GF4UMjoEXBMB0hhJA+zmqIYbgMOIAQgMbaEsFDe5+f29WkpgjAMCRBgVJQXBOHiK93NIIDriwTWRZ18hFB95FgKIzgBHDT7vp0pmTh5AH+ScyyhfBpBIeQmHjzh8WkZR8X0fAJFMexzDBHp13QUZsmKZB6nhF5656cZtk2BZjw2eADatp22Jjr50bBejm6xdRXXpYECRZfl0n2CV0AVbVxj2HNefte1p69YNrA0GN02kHN96J8E16PIieUkvrSPQAAfUEY3V6x824iYFjM4hctbnUAfbSY4lLZrS+txH6el-qUlhJIAA6qra4kABA-wksDFy88S5bDLigCuS9kY9FRm4Wu9c-5NzxvjVukh274XJpTHI+Mv5YLeozaefcCYDz+EPZCI8NJjw5lzHmB19pYOIOJWeF1hYL0TkvLsUtXqr2gbArS8DkKIOhAeaRk184gzBPgiApdzrEOOPDCWZCKEqCoa5RuuN6YQJkRIJheEWFdzCjTHh-cSaDzMVsYRSEtiFmiBEUgDxegA1wXJaxgw8QyTiYvNw8BBoAAMAAk1AAYeBybEmSxi+HQQZqFfGYZ8b5OoEkx8HgMkaT0nY-AANix1T6iRIaPQnHNwJq48S+MKIEwYe4oZhMhLE16B3Vh-gHqUV-OFHofilFuBED0QJvkwiNOQrufs0SehtJvtEMERSXLNNae045gwLip0AacuSilA4qUOR0wY0BOD4UGFWL8gxIBxCMIMJ0Cp0nHBeccwINyMBMGCCkqiHy8K9EAmCmIgR8ZsnxjC+5P4-yCF6D0QC3z2B4rYECrAWLQDIokKi9FwQ8X4sil+Ol3dehsD+UYbZWxzk3H2UYvBCjBiUthVy6EgrMh4p6XQomayejTO8QsuweLlkM2lYE+VwhejrEGryuSaEcbYVwkXCQiLQC7IeJSpE+MJX4wtSMwZlFxlxGtRSy5KL8Y8IxfSHFAhIYvBZfJclTRlD9kEKALqLRVg9HxXSnolFTXmoJrK58TqEmgHCdMKJlLUXuuCEiTN+NE1MAxS8T1fYfXRtjXs+NlqcaCCdYTAxoz7VE1zS6qlbqbgep8d6iAvrI2Rsok0PE0QCRCWIOfB4XVzzkvntGyNgFhWA1nX2od7AR1xDHaGCdxal2RtoH2-dkaJVsDzVa0IO7I0FuPa21FBaMXSoPZG5Z2TqB5uzR4QIOSGSCA8MEBp571kCOdUc11NL70HvWA+novaD1sDja2i1VqbXIMbX0iZSJn2vo7cEd9n7CTft-SWwQPqWjEq6X2kaZ1ICPkmERB441bIDSRNYl400V1ro3RgU8wVghTucqDBRs6fiQYrfsyDBz4P-vzcwzuSbBhiYSf+tNkSkBmuve26Ena823p43JyDardMPqCl5Hd9BoMHsomxzgo7x1GZ47CwN7Bg0OzDRGg9QnhMmsrfBgmiG+kNrtahx1SIlMZrU9msyxau2Q242Z8zoBB3Dqs+u8dk7YV0QYkxdgrmxOAVNf+vt5r8uRurbQ61RWej1sgShh1ZWxP7pCypzDGmc2gGfcJHD1Av0CB-Rk7ddW+36fK7ZorsWH2wb2eVwr-XiuIfK-Q5DAWasGbEw11TwG23hdazk9rH7Ot4e67+vr03BvTZ6F1EbJGxMDss9ZzdqXp0Cf6-Omu3Lys3eS3do7-W92naPUBjpqLT1gbq5e-74KpOeJk4Ws9p2ll01TRE0L62s1YfQ9tjrXWevolh4EvNoHysQf66NmDXbLsk-3EeE8tneMF2AhgHdgFVtNeuJ25aO6WD-pE0Vqb-WSu41q7z5tRWmdhdR0tL7Yn0uMWYrC2z0ERfI-Uyzlry1Qonf68NurpnOdURe9CUTdX3sca415CXkGfv9b+yemtAg73ldB1p6TrC7eneWQrgHSvWfY+m7jtT+PpuE8g9r8nXn1sIZt3W21Yzm0I-TY10XzWIuEe7dT+976qOKC7Cp+jhjIvMbPRnVqf0c43ChotC4sLmPHAr+Sx5ykIDGqChcWlPQ2A174z+fbeKCWkfbwXDJYYclBpDQAJUkEgepdLAK6OuGXo3NnItj4UGZtvsLn2Y+CEPxzo-x+T-3YBefm7JIBuH858NLf9-Z0hKXkyXUkRL6QKNswHl9hymYB-HhuQ28kyhkPfy0bV9yVn1T8loOsQCH899L9zJa8lIVJD9OMzwl1p8S9oQ59EtbsECXhuN79x9ic2AZ8y865QAH8n99I18t8nNQDB9qBwDd8MkkClpYU684D0CPtMCGcr9eRZ8TJ4CBpsDiDcD2dQBeDj8O94sQCXML8H1kDr9UDb8cDl9z1n9lBX84h38eEDRv8glmZ-8xsyCgDdsQD2tghqDaCFBIC3NGDyUutz0CV7MJDz9-0ZCuCy878BDFC6tlD2BVD1CbhTQtDf95JA8Sc+9il199sLDpDhDWDjdRCC4HNKDJD8tAJzt+svCfCmAP8bgswAjAN3xgiQimDYDojV0ktYjidL8RCsDm98tACxDwjbBut6DpsD8YiF97Dt8z9ss6sUjyt0i39MieFZxcjMA-8Ci9DMYVCBisjoRFwRidDxjW99CxCGZbCG8xM6iC4c87InDQAOoSoMAeo+o+CajPDXIpi1DBibhJx5ixiNJ+w6IiI+pkR4xSVol6BtUwQx8ogBAmAHgU0pdMtt16BQiXIZ885gTQBpRYUCCTIiCLhfUXgmgwYh4kRlkLgkRVCFQSUoIsh-Z4s2R68eFKAKAqAyhrFbQhoLBQAgwp5uZYgqAeE6UwxU40B11nomhgAAAdQIJoLkuoAAahaC5OCGAHwDVEHxtDJx6DDAkDZNVn1DDHzGpNpL4nXQUAmmODQHpKQDDB4jQFaHsBpOOT4h4mUFxi1J1JZKhU4A5NEGpKaBUR4Cs1IDOGf0CHvFmRUGml8n8iRAiBTlTnYATGdC9IlnmX2yggoHPCyGpMsBUkdKemdPXQbAEECADKwS-BDIVBhVJKoDoiSmxl-CYBIzjLjKdO4BdNTPTMDKzNJVzJoHCDLPoFTiQBTgFiTMrJTLOBrMzODPrKNPoA8HaGpLBntNAFjGpPxKaEJJUnVKQE1IAEJSTRgCyMAiyoVKS914z4szTgzBBAh5yJoYVEZEYmYiTcBzSDyjyxIYVlyqBZzQAsSMAoJeh6B1lrhjYGhfwGhMEf59RsIMinzEwsA2RlS4y9zcZDzboFzbzjhnzBzQBWz2zC4jT1ghzRBkKBB5E8IwggA
source: https://github.com/ciscoheat/sveltekit-superforms/blob/main/src/lib/stringPath.ts
---

```ts
// Thanks to https://stackoverflow.com/a/77451367/70894
type IsAny<T> = boolean extends (T extends never ? true : false) ? true : false;

export type AllKeys<T> = T extends T ? keyof T : never;

// eslint-disable-next-line @typescript-eslint/no-explicit-any
type PickType<T, K extends AllKeys<T>> = T extends { [k in K]: any } ? T[K] : never;

// Thanks to https://dev.to/lucianbc/union-type-merging-in-typescript-9al
export type MergeUnion<T> = {
	[K in AllKeys<T>]: PickType<T, K>;
};

/* eslint-disable @typescript-eslint/no-explicit-any */
export function splitPath(path: string) {
	return path
		.toString()
		.split(/[[\].]+/)
		.filter((p) => p);
}

export function mergePath(path: (string | number | symbol)[]) {
	return path.reduce((acc: string, next) => {
		const key = String(next);
		if (typeof next === "number" || /^\d+$/.test(key)) acc += `[${key}]`;
		else if (!acc) acc += key;
		else acc += `.${key}`;

		return acc;
	}, "");
}

type BuiltInObjects = Date | Set<unknown> | File;

/**
 * Lists all paths in an object as string accessors.
 */
export type FormPath<T extends object, Type = any> = string &
	StringPath<T, { filter: "all"; objAppend: never; path: ""; type: Type }>;

/**
 * List paths in an object as string accessors, but only with non-objects as accessible properties.
 * Similar to the leaves in a node tree, if you look at the object as a tree structure.
 */
export type FormPathLeaves<T extends object, Type = any> = string &
	StringPath<T, { filter: "leaves"; objAppend: never; path: ""; type: Type }>;

/**
 * List paths in an object as string accessors, but only with non-objects as accessible properties.
 * Also includes the _errors field for objects and arrays.
 */
export type FormPathLeavesWithErrors<T extends object, Type = any> = string &
	StringPath<T, { filter: "leaves"; objAppend: "_errors"; path: ""; type: Type }>;

/**
 * List all arrays in an object as string accessors.
 */
export type FormPathArrays<T extends object, Type = any> = string &
	StringPath<T, { filter: "arrays"; objAppend: never; path: ""; type: Type }>;

type Concat<Path extends string, Next extends string> = `${Path}${Path extends "" ? "" : "."}${Next}`;

type StringPathOptions = {
	filter: "arrays" | "leaves" | "all";
	objAppend: string | never;
	path: string;
	type: any;
};

type If<Options extends StringPathOptions, Pred extends keyof Options, Subj, Then, Else, Value> = Options[Pred] extends Subj
	? Options["type"] extends never
		? Then
		: Value extends Options["type"]
			? Then
			: never
	: Else;

type StringPath<
	T extends object,
	Options extends StringPathOptions = {
		filter: "all";
		objAppend: never;
		path: "";
		type: never;
	}
> = T extends BuiltInObjects
	? If<Options, "filter", "leaves" | "all", Options["path"], never, T>
	: T extends (infer U)[]
		?
				| If<Options, "objAppend", string, Concat<Options["path"], Options["objAppend"]>, never, T>
				| If<Options, "filter", "arrays" | "all", Options["path"], never, T>
				| (NonNullable<U> extends object
						? StringPath<
								NonNullable<U>,
								{
									filter: Options["filter"];
									objAppend: Options["objAppend"];
									path: `${Options["path"]}[${number}]`;
									type: Options["type"];
								}
							>
						: If<Options, "filter", "leaves" | "all", `${Options["path"]}[${number}]`, never, T>)
		: {
				[K in Extract<AllKeys<T>, string>]: NonNullable<T[K]> extends object
					?
							| If<Options, "objAppend", string, Concat<Options["path"], Options["objAppend"]>, never, T[K]>
							| NonNullable<T[K]> extends (infer U)[]
						?
								| If<Options, "filter", "arrays" | "all", Concat<Options["path"], K>, never, T[K]>
								| (NonNullable<U> extends unknown[]
										? If<Options, "filter", "arrays" | "all", Concat<Options["path"], `${K}[${number}]`>, never, T[K]>
										: If<Options, "filter", "leaves" | "all", Concat<Options["path"], `${K}[${number}]`>, never, U>)
								| (NonNullable<U> extends object
										? StringPath<
												NonNullable<U>,
												{
													filter: Options["filter"];
													objAppend: Options["objAppend"];
													path: Concat<Options["path"], `${K}[${number}]`>;
													type: Options["type"];
												}
											>
										: never)
						: IsAny<T[K]> extends true
							? Concat<Options["path"], K>
							:
									| If<
											Options,
											"filter",
											"all",
											Concat<Options["path"], K>,
											unknown extends T[K] ? Concat<Options["path"], K> : never,
											T[K]
									  >
									| StringPath<
											NonNullable<T[K]>,
											{
												filter: Options["filter"];
												objAppend: Options["objAppend"];
												path: Concat<Options["path"], K>;
												type: Options["type"];
											}
									  >
					: If<Options, "filter", "leaves" | "all", Concat<Options["path"], K>, never, T[K]>;
			}[Extract<AllKeys<T>, string>];

export type FormPathType<T, P extends string> = P extends keyof T
	? T[P]
	: P extends number
		? T
		: P extends `.${infer Rest}`
			? FormPathType<NonNullable<T>, Rest>
			: P extends `${number}]${infer Rest}`
				? NonNullable<T> extends (infer U)[]
					? FormPathType<U, Rest>
					: { invalid_path1: P; Type: T }
				: P extends `${infer K}[${infer Rest}`
					? K extends keyof NonNullable<T>
						? FormPathType<NonNullable<T>[K], Rest>
						: FormPathType<T, Rest>
					: P extends `${infer K}.${infer Rest}`
						? K extends keyof NonNullable<T>
							? FormPathType<NonNullable<T>[K], Rest>
							: NonNullable<T> extends (infer U)[]
								? FormPathType<U, Rest>
								: { invalid_path2: P; Type: T }
						: P extends `[${infer K}].${infer Rest}`
							? K extends number
								? T extends (infer U)[]
									? FormPathType<U, Rest>
									: { invalid_path3: P; Type: T }
								: P extends `${number}`
									? NonNullable<T> extends (infer U)[]
										? U
										: { invalid_path4: P; Type: T }
									: P extends keyof NonNullable<T>
										? NonNullable<T>[P]
										: P extends `${number}`
											? NonNullable<T> extends (infer U)[]
												? U
												: { invalid_path5: P; Type: T }
											: { invalid_path6: P; Type: T }
							: P extends ""
								? T
								: P extends AllKeys<T>
									? MergeUnion<T>[P]
									: { invalid_path7: P; Type: T };
```
