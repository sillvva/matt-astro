---
title: Useful TypeScript Helpers
description: Useful functions and type helpers for TypeScript
date: 2023-09-07T03:18:13.471Z
updated: 2024-05-04T18:00:30.634Z
image: $/assets/images/typescript.png
tags:
  - TypeScript
---
import TabbedCode from "$/components/markdown/code/tabbed.astro";
import Collapsible from "$/components/markdown/collapsible.astro";
import Tweet from "$/components/markdown/tweet.astro";

## Table of Contents

## Disclaimer

<aside class="alert-box oklch info">
	I want to preface this post with a disclaimer that the majority of the code in this post is not my own. I have collected it from various sources and have tried to give credit where credit is due. If you see something that you believe is your own work and I have not given you credit, please [let me know](https://github.com/sillvva/matt-astro/issues) and I will rectify the situation. If you see something that you believe is your own work and you would like it removed, please [let me know](https://github.com/sillvva/matt-astro/issues) and I will remove it.
</aside>

## Type Declarations

### View Transition

The `startViewTransition` function is a method on the `document` object which enables view transitions. The following types are based on the documentation at MDN. Since the API is currently experimental, you may need to add the following type to your type declaration file to avoid errors. 

<div class="button-row">
  [Google](btn::https://developer.chrome.com/docs/web-platform/view-transitions/)
  [MDN](btn::https://developer.mozilla.org/en-US/docs/Web/API/Document/startViewTransition)
</div>

<TabbedCode>
<Fragment slot="tab-1">app.d.ts</Fragment>
<Fragment slot="panel-1">
```ts
declare global {
	interface ViewTransition {
		/**
		 * A Promise that fulfills once the transition animation is finished, 
		 * and the new page view is visible and interactive to the user.
		 */
		finished: Promise<void>;
		/**
		 * A Promise that fulfills once the pseudo-element tree is created 
		 * and the transition animation is about to start.
		 */
		ready: Promise<void>;
		/**
		 * A Promise that fulfills when the promise returned by the 
		 * document.startViewTransition()'s callback fulfills.
		 */
		updateCallbackDone: Promise<void>;
		/**
		 * Skips the animation part of the view transition, but doesn't skip 
		 * running the document.startViewTransition() callback that updates the DOM.
		 */
		skipTransition: () => void;
	}

	type ViewTransitionCallback = (() => Promise<void>) | (() => void);

	interface Document {
		startViewTransition: (callback: ViewTransitionCallback) => ViewTransition;
	}
}
```
</Fragment>
</TabbedCode>

<Collapsible title="Using in SvelteKit">
  In SvelteKit, you can add the above type declaration to a file in the `src` directory, such as `src/types.d.ts`. Then you can add view transitions to your SvelteKit app by following the video below, ignoring the `@ts-ignore` comments.

  [YouTube](embed::https://www.youtube.com/watch?v=q_2irZO4SS8)
</Collapsible>

### Environment Variables

<div class="tweet-block">
	<div>
		Environment variables can be declared in the `global` namespace to provide type information for `import.meta.env` and `process.env`. The following example demonstrates how to declare environment variables in TypeScript.

		<div class="button-row">
			[Source](btn::https://twitter.com/mattpocockuk/status/1758454430666506589)
		</div>

		```ts
		declare global {
			interface ImportMetaEnv {
				MY_ENV: string;
			}
		}

		import.meta.env.MY_ENV; // string

		declare global {
			namespace NodeJS {
				interface ProcessEnv {
					MY_ENV: string;
				}
			}
		}

		process.env.MY_ENV; // string
		```
	</div>
	<aside>
		<Tweet link="https://twitter.com/mattpocockuk/status/1758454430666506589" />
	</aside>
</div>

Keep in mind that this is type faith, not type safe. You can also [use a schema validation library](https://twitter.com/mattpocockuk/status/1760991147793449396) to parse your environment variables and infer the type from that. If a variable is missing, you can throw an error.


## Utility Types


<div class="tweet-block">
	<div>
		### Combine/Prettify Two Object Types

		The `Prettify` type is a simple type which takes an object type with intersections and combines them to make them easier to read. The `Combine` type is a simple type which takes 2 object types and combines them into one.

		<div class="button-row">
			[Playground](btn::https://www.typescriptlang.org/play?#code/PTAEGEHkBEFECh4BcCeAHApqACgJw0kgJYBmKAPACoB8oAvKAN7yigDaA0qEQHagDWGFAHsSoSgF0AXOM4SA3PAC+oAGRMli5OizhhAWwBGvDFQCMAGnEAmWgzwFiZciyavWnbn0EixACkozUAAfGwBKaXEzORCbOUVWFXVsAENcYhSAG3M1G2p4ai0QcVgAZUpSxCJ9NGF0plBYAEcAVyyrWAAPTABjJFAVElwDUAAiAAEkYSQsgFpUTABnHtwiNCRgAAsMTMxcRdGtBaxKHQBBejdWfBSAE2EeTJRQHhT9DBlFpFWeAHME0A3e6PZ53W74RaLT7fXj-ZRHHTiHQAIUujEBGDuDyeLzeH1AXx+-1AaE2D3xhNhAwRmFAACUMIsWpl+gw9EYTFRzlZTphkYVEMdGt0MH0MLc0a4gdjnq93tCiQDpSDQGCIYsAPwK2EA0nkrUEmF-RSaQWIpCM1nC3pIcjNNrZBlMlkdEVi27UAVAA)
			[Prettify Source](btn::https://twitter.com/mattpocockuk/status/1622730173446557697)
			[Combine Source](btn::https://twitter.com/mattpocockuk/status/1712391832573718721)
		</div>

		```ts
		type Prettify<T> = {
			[K in keyof T]: T[K];
		} & {};

		type Combine<T1, T2> = Prettify<
			{
				[K in keyof (T1 | T2)]: T1[K] | T2[K];
			} & Partial<T1 & T2>
		>;
		```
	</div>
	<aside>
		<Tweet link="https://twitter.com/mattpocockuk/status/1712391832573718721" />
	</aside>
</div>

#### Prettifying Nested Objects

Going even further, you can use the `PrettifyNested` type to prettify nested object types. The `Record<PropertyKey, unknown>` type extends basic objects, but not classes like `Date`, `Map`, `Set`, etc.

<div class="button-row">
	[Playground](btn::https://www.typescriptlang.org/play/?#code/C4TwDgpgBACgThYwCWAzEAeAKgPigXigG8AoKKAbQGkpkA7KAawhAHtUosBdALk+q4BuEgF8oAMmIjhJUJFgIkaEADkIAZ2AQAJtjyFS5arQbM2HbnywCoEAB5a629VABKEAMas4u+K0hwoFQsADRQAK50jHSsAO50eAD8Cogo6GqaOtgCeFYCwmKSRNIksuDQAELhyAA2wACSdADyAEYAVp7ABFAAIgCGWlAAPm4QAOYAonZgw1AAyogYfXQgeCMAsn1gSythy6uzAOoQfYwLwDsHI8enm9v7eytrCqwAtsjqEJfPE3Bw3rMAIJ-PogKqoVAQOCzOYACz6CG0wLgoPBkOhI0awAAHMjQbMAKr0HF4kCE4nYgDCNT6r0gSJBZMxdGAAEYAGyk8ksjlc5nAADMACY+VAiSzhaKAGI1VgDSWM2YyuXAdkAFlJMjk0DuYHoY26dwwmjg+rCdHCrxaUJwMm0nhpCCgXjomigAH13S0UU4+JFkABHcLQdQgK2sGpleQVH26Cr6YiUT3e5baXhQCpQERRyqxrJYMLx7pYCQZ2MYeOlbWwBEQFndQxMFh8ADk-hQrDoAFpWS3RFXylBKbDatoG2QmyBW+3kJ2u0KW8JyGBayy+DBV8Al1BXls+Lr9duWtU6vQ+FVag1mu1OkfY+e87oTWaoAAiGOp1+2icIuB8fpaBQQj9jmUAqN4u41N08CpMoGDDqO34APRIeQUAAHqJKBGRaGOhAwUo6QaLh8EjjU2g4CQKFoZhQA)
</div>

```ts
type PrettifyNested<T> = {
  [K in keyof T]: T[K] extends Record<PropertyKey, unknown> ? PrettifyNested<T[K]> : T[K];
} & {};
```

#### Merging Nested Objects

<div class="button-row">
	[Playground](btn::https://www.typescriptlang.org/play/?#code/C4TwDgpgBAyglgWzAGzgMxAHgCoD4oC8UA3gFBQVQDaA0lHAHZQDWEIA9mlNgLoBc3Wj1IBfKADIoAVwbMG7AO4MA3KVIB6AFSbymqAAFUsqAAtgwMAGc+69QHM4wE1IBGAOgDG7BOrguGyACGDABOEOqgkJa66qSR0ACyECF2EJjksOxSIR7QEAAewBAMACaWUOwuAFYQHsAANBnYgSkQwFAFRaXllTV1pPhE8EioGOkUZJTUNGz0TKwcXDBZOdCB5TMgHYXFZSxsnNwtqcAZUwD8UAwQAG7JZ5QCm-yZ2bm0bDyqFGKSk5QfLaMfaLI6tdrrKCbbZdPYLQ7LN4QB4US7XO4hFFQJ6fATNcGAr4ZX4kB6AuYghErXISSlcfEnF6I1aEmG7HrVWqnKaosEnVmddkVTn9HmUS5JVqYZnvZ71PltQm4LEUPHHRXPLFqgnPb5QEQDVRxcDQACChBIV0CCAgAkswBCjDsyiggVSdodTpdgRKJTClmslrglgA+h5HCABC52OxkBBgvr9ap4lAAEIW4hWm0ex0MZ2u91XKQIFzJb2+-2BzNeGQOyNQe25uyJkRGlPYCD2i2S1KYU3y1PK2xTAB65yAA)
	[Source](btn::https://github.com/ibnlanre/types)
</div>

```ts
type Merge<
  Source extends object,
  Target extends object
> = Simplify<
  {
    [Key in keyof Source as Key extends keyof Target
      ? never
      : Key]: Source[Key];
  } & {
    [Key in keyof Target as Key extends keyof Source
      ? never
      : Key]: Target[Key];
  } & {
    [Key in keyof Source & keyof Target]: Source[Key] extends object
      ? Target[Key] extends object
        ? Merge<Source[Key], Target[Key]>
        : Target[Key]
      : Target[Key];
  }
>;
```

### Merge Union Types

The `MergeUnion` type is a utility type that does as its name suggests. It takes multiple union types and merges them into one.

<div class="button-row">
  [Source](btn::https://dev.to/lucianbc/union-type-merging-in-typescript-9al)
</div>

```ts
export type AllKeys<T> = T extends T ? keyof T : never;

export type PickType<T, K extends AllKeys<T>> = T extends { [k in K]: infer Item } ? Item : never;

export type MergeUnion<T> = {
	[K in AllKeys<T>]: PickType<T, K>;
};
```

### Numeric Range

The `NumericRange` type is a utility type that takes a start and end number and returns a union of all numbers between the two.

<div class="button-row">
  [Source](btn::https://github.com/sveltejs/kit)
</div>

```ts
type LessThan<TNumber extends number, TArray extends any[] = []> = TNumber extends TArray["length"]
	? TArray[number]
	: LessThan<TNumber, [...TArray, TArray["length"]]>;

type NumericRange<TStart extends number, TEnd extends number> =
	| Exclude<TEnd, LessThan<TStart>>
	| Exclude<LessThan<TEnd>, LessThan<TStart>>;
```

## Type Guards

### IsAny

You can (ab)use the fact that any is both a subtype and a supertype of almost everything (except for never). So the inner [(Distributive) Conditional Type](https://www.typescriptlang.org/docs/handbook/2/conditional-types.html#distributive-conditional-types) resolves to a Union of `true | false (=boolean)` instead of either of them.

<div class="button-row">
	[Playground](btn::https://www.typescriptlang.org/play?#code/C4TwDgpgBAkgzgQQHYgDwBUB8UC8UBGA9oQDYQCGSUEAHsBEgCZxQAU61dDzUSEAbhABOUAPxRgQgK7QAXFABm5EnAgBKMROlzFy1QG4AsACgToSFAS5YiFKkohMJgPTOo7gHqiz4aACFreGQ0JCkAW3xhJ2NXdygvHwsAYUDbNCkkAGskQgB3JGjYz29jc2gAEVTg1D5BIUK3YsToAFEqu35CAEtGBriE0t8oADF2tABvAF8+psGLAHEx1EJ8ACsIAGNgGfiSsqgACSWMxggFLr5el0bd5tgl0JISHa8gA)
  [Source](btn::https://stackoverflow.com/a/77451367/70894)
</div>

```ts
type IsAny<T> = boolean extends (T extends never ? true : false) ? true : false;
```

### Satisfies

The `Satisfies` type is a utility type that checks if a type satisfies an expected type and returns the actual type.

<div class="button-row">
	[Playground](btn::https://www.typescriptlang.org/play?#code/C4TwDgpgBACgTgSwLYOAgbtAvFArgOwBMIAzBfCQqAHyn1wBsGaoAjAe3YYgEN8X6SVhDgtWCAOblgLAM7BE+CQG4AUKEixEKNJgDyrAFYQAxjJwAlU+ziEAPPMUSANFuSoMEAHxr14aADKPGiyZBCydgCiAB6QZpSuAIJmuDzMENHAEESyUDFxWYReUDjJwKkMvhrQAMLsSGDc0QbGZiVQAN6qUD1QJJwAXFCO5BLdvaw8cENWJjb2I0quixJeqgC+qn6aAciNEC2m5lBBIWER4z3w7roHRkfOl7AIJgDWdnUNTYdmrgBE-XYfzWa220AAQjxCLsvndWsdTghQghwnYntcdJ4fsBHr1nm8PvV9s17r8oADOH8WH9JnBgao1kA)
	[Source](btn::https://twitter.com/buildsghost/status/1770530554028675254)
</div>

```ts
type Primitive = undefined | null | boolean | number | bigint | string;
type PrimitiveObject = Record<string, Primitive>;

type Satisfies<Expected, Actual extends Expected> = Actual;

type ComplexObject = {
		foo: string
		bar: Record<string, string>
}

type SimpleObject = Satisfies<
		PrimitiveObject,
		Pick<ComplexObject, "foo">
>;

// [!code word:Pick\<]
// [!code word:ComplexObject\,]
// [!code word:\ "foo"\ |\ "bar"\>]
type BadSimpleObject = Satisfies<
		PrimitiveObject,
		Pick<ComplexObject, "foo" | "bar"> // Property 'bar' is incompatible with index signature. // [!code error]
>;
```